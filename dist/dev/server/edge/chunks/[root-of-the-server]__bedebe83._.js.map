{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/auth.ts"],"sourcesContent":["export type UserRole = \"student\" | \"faculty\" | \"admin\";\n\nexport const AUTH_COOKIE_TOKEN = \"tclass_token\";\nexport const AUTH_COOKIE_ROLE = \"tclass_role\";\n\nconst ROLE_HOME: Record<UserRole, string> = {\n  student: \"/student\",\n  faculty: \"/faculty\",\n  admin: \"/admin\",\n};\n\nexport function normalizeRole(role: string | null | undefined): UserRole | null {\n  if (!role) return null;\n  const value = role.toLowerCase().trim();\n  if (value === \"student\" || value === \"faculty\" || value === \"admin\") {\n    return value;\n  }\n  return null;\n}\n\nexport function getRoleHome(role: UserRole): string {\n  return ROLE_HOME[role];\n}\n\nexport function isProtectedPath(pathname: string): boolean {\n  return pathname.startsWith(\"/student\") || pathname.startsWith(\"/faculty\") || pathname.startsWith(\"/admin\");\n}\n\nexport function canAccessPath(role: UserRole, pathname: string): boolean {\n  if (pathname.startsWith(\"/student\")) return role === \"student\";\n  if (pathname.startsWith(\"/faculty\")) return role === \"faculty\";\n  if (pathname.startsWith(\"/admin\")) return role === \"admin\";\n  return true;\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAEO,MAAM,oBAAoB;AAC1B,MAAM,mBAAmB;AAEhC,MAAM,YAAsC;IAC1C,SAAS;IACT,SAAS;IACT,OAAO;AACT;AAEO,SAAS,cAAc,IAA+B;IAC3D,IAAI,CAAC,MAAM,OAAO;IAClB,MAAM,QAAQ,KAAK,WAAW,GAAG,IAAI;IACrC,IAAI,UAAU,aAAa,UAAU,aAAa,UAAU,SAAS;QACnE,OAAO;IACT;IACA,OAAO;AACT;AAEO,SAAS,YAAY,IAAc;IACxC,OAAO,SAAS,CAAC,KAAK;AACxB;AAEO,SAAS,gBAAgB,QAAgB;IAC9C,OAAO,SAAS,UAAU,CAAC,eAAe,SAAS,UAAU,CAAC,eAAe,SAAS,UAAU,CAAC;AACnG;AAEO,SAAS,cAAc,IAAc,EAAE,QAAgB;IAC5D,IAAI,SAAS,UAAU,CAAC,aAAa,OAAO,SAAS;IACrD,IAAI,SAAS,UAAU,CAAC,aAAa,OAAO,SAAS;IACrD,IAAI,SAAS,UAAU,CAAC,WAAW,OAAO,SAAS;IACnD,OAAO;AACT"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\nimport {\n  AUTH_COOKIE_ROLE,\n  AUTH_COOKIE_TOKEN,\n  canAccessPath,\n  getRoleHome,\n  isProtectedPath,\n  normalizeRole,\n} from \"@/lib/auth\";\n\nexport function middleware(request: NextRequest) {\n  const { pathname, search } = request.nextUrl;\n  const token = request.cookies.get(AUTH_COOKIE_TOKEN)?.value;\n  const role = normalizeRole(request.cookies.get(AUTH_COOKIE_ROLE)?.value);\n  const isAuthenticated = Boolean(token && role);\n\n  if (pathname === \"/login\") {\n    if (isAuthenticated && role) {\n      return NextResponse.redirect(new URL(getRoleHome(role), request.url));\n    }\n    return NextResponse.next();\n  }\n\n  if (!isProtectedPath(pathname)) {\n    return NextResponse.next();\n  }\n\n  if (!isAuthenticated || !role) {\n    const loginUrl = new URL(\"/login\", request.url);\n    loginUrl.searchParams.set(\"redirect\", `${pathname}${search}`);\n    return NextResponse.redirect(loginUrl);\n  }\n\n  if (!canAccessPath(role, pathname)) {\n    return NextResponse.redirect(new URL(getRoleHome(role), request.url));\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\"/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)\"],\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AASO,SAAS,WAAW,OAAoB;IAC7C,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,QAAQ,OAAO;IAC5C,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,wIAAiB,GAAG;IACtD,MAAM,OAAO,IAAA,oIAAa,EAAC,QAAQ,OAAO,CAAC,GAAG,CAAC,uIAAgB,GAAG;IAClE,MAAM,kBAAkB,QAAQ,SAAS;IAEzC,IAAI,aAAa,UAAU;QACzB,IAAI,mBAAmB,MAAM;YAC3B,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,IAAA,kIAAW,EAAC,OAAO,QAAQ,GAAG;QACrE;QACA,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,IAAI,CAAC,IAAA,sIAAe,EAAC,WAAW;QAC9B,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,IAAI,CAAC,mBAAmB,CAAC,MAAM;QAC7B,MAAM,WAAW,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9C,SAAS,YAAY,CAAC,GAAG,CAAC,YAAY,GAAG,WAAW,QAAQ;QAC5D,OAAO,gMAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,IAAI,CAAC,IAAA,oIAAa,EAAC,MAAM,WAAW;QAClC,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,IAAA,kIAAW,EAAC,OAAO,QAAQ,GAAG;IACrE;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAA2E;AACvF"}}]
}